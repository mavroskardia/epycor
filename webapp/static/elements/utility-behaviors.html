<script>

    (function () {

        if (!window.Epycor) window.Epycor = {};

        Epycor.UtilityBehaviors = {

            asBase64: function (date) {
                let start = moment(date).day(0).hour(0).minute(0).unix();
                let end = moment(date).day(6).hour(23).minute(59).unix();
                return btoa(start + '|' + end);
            },

            groupBy: function (xs, key) {
                return xs.reduce((rv, x) => {
                    (rv[x[key]] = rv[x[key]] || []).push(x);
                    return rv;
                }, {});
            },

            groupByAsArray: function (xs, key) {
                
                let final = [];
                let grouped = Epycor.UtilityBehaviors.groupBy(xs, key);

                for (var k in grouped) {
                    final.push({
                        key: k,
                        values: grouped[k]
                    });
                }

                return final;

            }

        };

    }());

</script>