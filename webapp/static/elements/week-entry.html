<dom-module id="week-entry">
  <template>
    <style include="shared-styles">

      strong, small {
        text-align: center;
        width: 2.5rem;
        padding: 2px;
      }

      strong {
        border: solid 1px var(--primary-color);
        background-color: var(--primary-color);
        color: #fff;
      }

      paper-input {
        text-align: right;
        font-weight: 600;
      }

      strong.weekend {
        background-color: #ddd;
        color: #aaa;
        border-color: #ddd;
      }

    </style>

    <div id="container" class="horizontal layout center center-center">
      <template is="dom-repeat" items="{{charges}}">
        <div class="vertical layout center flex container">
          <header class="vertical layout center">
            <strong class$="[[_computeDayClass(currentDate, index)]]">
              [[toDay(currentDate, index)]]
            </strong>
            <small>[[toShort(currentDate, index)]]</small>
          </header>
          <paper-input
            type="number"
            min="0"
            max="24"
            value="{{item.hours}}"
            no-label-float>
          </paper-input>
        </div>
      </template>
    </div>

  </template>
  <script>
    (() => {
      'use strict';

      class WeekEntry {

        get is() { return 'week-entry' }

        get properties() {
          return {
            charges: {
              type: Array,
              notify: true,
              value: () => [
                { hours: 0 },
                { hours: 0 },
                { hours: 0 },
                { hours: 0 },
                { hours: 0 },
                { hours: 0 },
                { hours: 0 }
              ]
            }
          }
        }

        get observers() {
          return ['currentDateChanged(currentDate)'];
        }

        clear() {
          this.charges.forEach(c => c.hours = 0);
        }

        currentDateChanged(date) {
          console.log('caught date change to ' + date);
        }

        toDay(date, index) {
          return moment(date).add(index, 'days').format('ddd');
        }

        toShort(date, index) {
          return moment(date).add(index, 'days').format('M/D');
        }

        _computeDayClass(date, index) {
          let d = moment(date).add(index, 'days').day();
          return (d == 0 || d == 6) ? 'weekend' : '';
        }

      }

      Polymer(WeekEntry);

    })();
  </script>
</dom-module>