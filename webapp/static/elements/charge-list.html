<dom-module id="charge-list">
  <template>
    <style include="shared-styles">

      iron-list,
      paper-listbox {
        height: 29vh;
        overflow: auto;
      }

      charge-item.iron-selected {
        background-color: var(--primary-color);
        color: #fff;
      }

    </style>

    <paper-listbox id="chargesList" multi
      on-iron-select="highlightSelected">
      <template is="dom-repeat" items="[[sortedCharges(charges.*)]]">
        <charge-item charge="[[item]]"></charge-item>
      </template>
    </paper-listbox>

  </template>
  <script>
    (() => {
      'use strict';

      class ChargeList {
        static get is() { return 'charge-list' }

        get behaviors() {
          return [
            Polymer.NeonAnimationRunnerBehavior
          ];
        }

        get properties() {
          return {
            animationConfig: {
              value: function () {
                return {
                  'cool': [{
                    name: 'cascaded-animation',
                    animation: 'fade-in-animation'
                  }]
                };
              }
            }
          };
        }

        get observers() {
          return [ 'selectedChargesChanged(selectedCharges)' ];
        }

        highlightSelected(e, detail) {
          this.$.chargesList.select(detail.item);
        }

        animate() {
          let items = Polymer.dom(this.root).querySelectorAll('charge-item');
          this.animationConfig['cool'][0].nodes = items;
          this.playAnimation('cool');
        }

        sortedCharges(chargesPath) {
          return chargesPath.base
            .sort((a, b) => moment(a.TimeEntryDate) - moment(b.TimeEntryDate));
        }

        selectAll() {
          this.$.chargesList.items.forEach((item, i) => this.$.chargesList.select(i));
        }

      }

      Polymer(ChargeList);

    })();
  </script>
</dom-module>